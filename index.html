<html>

<head>
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <h1 id="text">hello world</h1>
    <script>
        const text = document.getElementById('text')

        const socket = io();

        setText('connecting')

        let state = 0;

        const possibleStates = [
            'red',
            'prange',
            'yellow',
            'green',
            'blue',
            'purple',
            'magenta',
            'pink',
            'white',
            'black'
        ]

        socket.on('state', (serverState) => (state = serverState));

        //socket.on('doStep', doStep);


        setInterval(doStep, 100)

        function doStep() {
            if (state < 100) {
                state++
            } else {
                state = 0
            }
            //document.body.style.backgroundColor = possibleStates[state]
            setText(n(state, '|') + state)
        }

        function n(n, string) {
            let x = ''
            for (let i = 0; i < n; i++) {
                x += string
            }
            return x
        }

        function setText(newText) {
            text.textContent = newText
        }

        {
            socket.on('connect', () => {
                setText('connected')
                console.log('connected')
            });

            socket.on('disconnect', (reason) => {
                setText('disconnected: ' + reason)
                console.log('disconnected: ' + reason)
            });

            socket.on('reconnect_attempt', (attemptNumber) => {
                setText('reconnect_attempt: ' + attemptNumber)
                console.log('reconnect_attempt: ' + attemptNumber)
            });

            socket.on('reconnecting', (attemptNumber) => {
                setText('reconnecting: ' + attemptNumber)
                console.log('reconnecting: ' + attemptNumber)
            });

            socket.on('reconnect_error', (error) => {
                setText('reconnect_error: ' + JSON.stringify(error, 2))
                console.log('reconnect_error: ' + JSON.stringify(error, 2))
            });

            socket.on('reconnect_failed', () => {
                setText('reconnect_failed')
                console.log('reconnect_failed')
            });

            socket.on('ping', () => {
                setText('ping')
                console.log('ping')
            });

            socket.on('pong', (latency) => {
                setText('pong - latency: ' + latency)
                console.log('pong - latency: ' + latency)
            });

            socket.on('reconnect', (attemptNumber) => {
                setText('reconnected: ' + attemptNumber)
                console.log('reconnected: ' + attemptNumber)
            });

            socket.on('connect_timeout', (timeout) => {
                setText('connect_timeout: ' + timeout)
                console.log('connect_timeout: ' + timeout)
            });

            socket.on('error', (error) => {
                setText('error: ' + JSON.stringify(error, 2))
                console.log('error: ' + JSON.stringify(error, 2))
            });

            socket.on('connect_error', (error) => {
                setText('connection error: ' + JSON.stringify(error, 2))
                console.log('connection error: ' + JSON.stringify(error, 2))
            });
        }
    </script>
</body>

</html>
